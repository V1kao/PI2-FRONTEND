<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
        integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="src/styles/stylesCadastro.css">
    <link rel="stylesheet" href="src/styles/cadastroBotaoVoltar.css">

    <title>Cadastro - SAGE</title>
</head>

<body>
    <!-- Notificação -->
    <div id="notification" class="notification"></div>

    <!-- Botão de Voltar -->
    <a href="#" class="back-button-cadastro" onclick="history.back(); return false;">
        <i class="fa-solid fa-arrow-left"></i>
        Voltar
    </a>

    <div class="container">
        <div class="header">
            <h1>SAGE</h1>
            <p>Sistema de Gestão Energética</p>
        </div>

        <!-- Formulário de Login (TELA PRINCIPAL) -->
        <div class="form-container active" id="formContainer">
            <div class="form-header">
                <h2 id="formTitle">Login Administrador</h2>
                <p id="formSubtitle">Acesso ao sistema de gestão</p>
            </div>

            <form id="registrationForm">
                <div class="form-group">
                    <label for="email">Email *</label>
                    <input type="email" id="email" class="form-input" placeholder="seu@email.com" required>
                </div>

                <div class="form-group">
                    <label for="password">Senha *</label>
                    <input type="password" id="password" class="form-input" placeholder="Digite sua senha" required>
                </div>

                <button type="submit" class="submit-btn">
                    Entrar no Dashboard
                </button>

                <div class="signup-link">
                    <p>Primeira vez aqui? <a href="#" onclick="showCompanyRegistration()" class="signup-btn">Cadastre
                            sua empresa</a></p>
                </div>
            </form>
        </div>

        <!-- Formulário de Cadastro de Empresa + Admin -->
        <div class="form-container" id="companyFormContainer">
            <div class="form-header">
                <h2>Cadastro de Empresa</h2>
                <p>Preencha os dados da empresa e do administrador</p>
            </div>

            <form id="companyForm">
                <!-- DADOS DA EMPRESA -->
                <h3
                    style="color: #f7ce3e; margin: 30px 0 20px 0; font-size: 1.3rem; border-bottom: 2px solid #c5c1c0; padding-bottom: 10px;">
                    Dados da Empresa
                </h3>

                <div class="form-group">
                    <label for="companyName">Nome Fantasia *</label>
                    <input type="text" id="companyName" class="form-input"
                        placeholder="Nome pelo qual a empresa é conhecida" required>
                </div>

                <div class="form-group">
                    <label for="razaoSocial">Razão Social *</label>
                    <input type="text" id="razaoSocial" class="form-input" placeholder="Razão social registrada"
                        required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="companyCnpj">CNPJ *</label>
                        <input type="text" id="companyCnpj" class="form-input" placeholder="00.000.000/0000-00" required
                            maxlength="18">
                    </div>
                    <div class="form-group">
                        <label for="phone">Telefone *</label>
                        <input type="tel" id="phone" class="form-input" placeholder="(11) 99999-9999" required
                            maxlength="15">
                    </div>
                </div>

                <!-- ENDEREÇO -->
                <h3
                    style="color: #f7ce3e; margin: 30px 0 20px 0; font-size: 1.3rem; border-bottom: 2px solid #c5c1c0; padding-bottom: 10px;">
                    Endereço
                </h3>

                <div class="form-row">
                    <div class="form-group" style="flex: 0 0 30%;">
                        <label for="cep">CEP *</label>
                        <input type="text" id="cep" class="form-input" placeholder="00000-000" required maxlength="9">
                    </div>
                    <div class="form-group" style="flex: 1;">
                        <label for="logradouro">Logradouro *</label>
                        <input type="text" id="logradouro" class="form-input" placeholder="Rua, Avenida, etc." required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group" style="flex: 0 0 25%;">
                        <label for="numero">Número *</label>
                        <input type="number" id="numero" class="form-input" placeholder="123" required min="0">
                    </div>
                    <div class="form-group" style="flex: 1;">
                        <label for="bairro">Bairro *</label>
                        <input type="text" id="bairro" class="form-input" placeholder="Nome do bairro" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="city">Cidade *</label>
                        <input type="text" id="city" class="form-input" placeholder="Nome da cidade" required>
                    </div>
                    <div class="form-group" style="flex: 0 0 30%;">
                        <label for="state">Estado *</label>
                        <select id="state" class="form-select" required>
                            <option value="">UF</option>
                            <option value="AC">AC</option>
                            <option value="AL">AL</option>
                            <option value="AP">AP</option>
                            <option value="AM">AM</option>
                            <option value="BA">BA</option>
                            <option value="CE">CE</option>
                            <option value="DF">DF</option>
                            <option value="ES">ES</option>
                            <option value="GO">GO</option>
                            <option value="MA">MA</option>
                            <option value="MT">MT</option>
                            <option value="MS">MS</option>
                            <option value="MG">MG</option>
                            <option value="PA">PA</option>
                            <option value="PB">PB</option>
                            <option value="PR">PR</option>
                            <option value="PE">PE</option>
                            <option value="PI">PI</option>
                            <option value="RJ">RJ</option>
                            <option value="RN">RN</option>
                            <option value="RS">RS</option>
                            <option value="RO">RO</option>
                            <option value="RR">RR</option>
                            <option value="SC">SC</option>
                            <option value="SP">SP</option>
                            <option value="SE">SE</option>
                            <option value="TO">TO</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="complemento">Complemento</label>
                    <input type="text" id="complemento" class="form-input" placeholder="Andar, sala, bloco (opcional)">
                </div>

                <!-- DADOS DO ADMINISTRADOR -->
                <h3
                    style="color: #f7ce3e; margin: 30px 0 20px 0; font-size: 1.3rem; border-bottom: 2px solid #c5c1c0; padding-bottom: 10px;">
                    Dados do Administrador
                </h3>

                <div class="form-group">
                    <label for="adminName">Nome Completo *</label>
                    <input type="text" id="adminName" class="form-input" placeholder="Nome do administrador" required>
                </div>

                <div class="form-group">
                    <label for="adminEmail">Email *</label>
                    <input type="email" id="adminEmail" class="form-input" placeholder="email@empresa.com" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="adminPassword">Senha *</label>
                        <input type="password" id="adminPassword" class="form-input" placeholder="Mínimo 6 caracteres"
                            required minlength="6">
                    </div>
                    <div class="form-group">
                        <label for="adminConfirmPassword">Confirmar Senha *</label>
                        <input type="password" id="adminConfirmPassword" class="form-input" placeholder="Repita a senha"
                            required minlength="6">
                    </div>
                </div>

                <button type="submit" class="submit-btn" id="companySubmitBtn">
                    Cadastrar Empresa e Administrador
                </button>

                <button type="button" class="back-btn" onclick="backToLogin()">
                    ← Voltar ao Login
                </button>
            </form>
        </div>
    </div>

    <script src="src/javaScript/api-service.js"></script>
    <script src="src/javaScript/cadastroBotaoVoltar.js"></script>
    <script src="src/javaScript/cadastro-integration.js"></script>

    <script>
        // Funções de navegação
        function showCompanyRegistration() {
            document.getElementById('formContainer').classList.remove('active');
            setTimeout(() => {
                document.getElementById('companyFormContainer').classList.add('active');
            }, 300);
        }

        function backToLogin() {
            document.getElementById('companyFormContainer').classList.remove('active');
            setTimeout(() => {
                document.getElementById('formContainer').classList.add('active');
            }, 300);
            document.getElementById('companyForm').reset();
        }

        // Máscaras para inputs
        document.getElementById('companyCnpj')?.addEventListener('input', function (e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length <= 14) {
                value = value.replace(/^(\d{2})(\d)/, '$1.$2');
                value = value.replace(/^(\d{2})\.(\d{3})(\d)/, '$1.$2.$3');
                value = value.replace(/\.(\d{3})(\d)/, '.$1/$2');
                value = value.replace(/(\d{4})(\d)/, '$1-$2');
            }
            e.target.value = value;
        });

        document.getElementById('phone')?.addEventListener('input', function (e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length <= 11) {
                value = value.replace(/^(\d{2})(\d)/, '($1) $2');
                value = value.replace(/(\d{5})(\d)/, '$1-$2');
            }
            e.target.value = value;
        });

        document.getElementById('cep')?.addEventListener('input', function (e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length <= 8) {
                value = value.replace(/^(\d{5})(\d)/, '$1-$2');
            }
            e.target.value = value;
        });

        // Buscar CEP automaticamente
        document.getElementById('cep')?.addEventListener('blur', async function () {
            const cep = this.value.replace(/\D/g, '');
            if (cep.length === 8) {
                try {
                    const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
                    const data = await response.json();

                    if (!data.erro) {
                        document.getElementById('logradouro').value = data.logradouro || '';
                        document.getElementById('bairro').value = data.bairro || '';
                        document.getElementById('city').value = data.localidade || '';
                        document.getElementById('state').value = data.uf || '';
                        document.getElementById('complemento').value = data.complemento || '';
                    }
                } catch (error) {
                    console.error('Erro ao buscar CEP:', error);
                }
            }
        });
    </script>
</body>

</html>